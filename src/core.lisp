(in-package :hylas)
(annot:enable-annot-syntax)

@document "Defines special forms and code language functions."

@doc "Please don't look at this code. Just don't. Please forgive me."
(defmacro extract (form (&rest bindings) &rest code)
  (let* ((str (make-string-output-stream))
         (bindings (loop for i from 0 to (1- (length bindings)) collecting
                     `((code (emit-code (nth ,i ,form) code))
                       (,(nth i bindings) (res code))
                       (,(read-from-string
                           (concatenate 'string
                             (symbol-name (nth i bindings)) "-type"))
                         (res-type code)))))
         (len (length bindings)))
    (format str "戾舄窿誉忾钿轭珞泔溴ㄤ雉轫弩ㄩ戾瞟黩轸瀛篝蜷铉篝颟蝈徜骝镯篝蜷铉ㄧ弭秕麴豸篝蝈犴篝蜷铉篝颟┅ㄤ彐磲泸屮趄徙舡扉篝ㄦ矧蝈篝泔溴啜戾è屮趄徙翦洵蝈玳篝弪扉篝┅ㄥ趄徙翦洵豉疱扉篝┅祜镳骘沐祆轭骘蝽滹戾è铄鳝泔溴ㄥ黹舡泔溴沐祆泔溴┅瘐箬蝈铄鳝泔溴屮趄徙翦洵蝈玳篝弪螬瘐箬蝈蟓豉疱铄鳝泔溴屮趄徙翦洵豉疱螬箦翩泔溴ㄣ镳泔溴铄鳝泔溴┅┅箦翩屮趄徙翦洵蝈玳篝弪蝈鲥蝮屮趄徙翦洵蝈玳篝弪螬箦翩屮趄徙翦洵豉疱蝈鲥蝮屮趄徙翦洵豉疱螬楞镤濠ㄤ彐磲泸鏖翳铄鳝筱镳ㄣ镤瀛篝狒蝈篝泔溴啜戾è泔溴ㄣ镳泔溴泔溴篝狒濠┅瘐箬磲脲轭篝犷沐Ъ筱镳寰篝徙泔溴┅楞镤濠ㄤ彐疳蜥礤翦镳弪狒矧螵磲脲栳箬翎忪呼弩＇羼踽飑ㄤ彐疳蜥礤翦泔蝈磲脲栳箬翎忪呼弩＇羼踽飑ㄤ彐磲泸溴驸蹰祠轭翎忪钺礤蝈篝泔溴啜箦翩ㄧ弭栳箬ㄦ矧磲铋窿簌礅镬钺礤钺礤┅翎忪濠＇灬礅溽ㄦ矧泔溴楞镤濠┅ㄤ彐磲泸溴骘钺礤蝈篝泔溴啜溴驸蹰祠轭镳弪狒矧螵钺礤楞镤濠ㄤ彐磲泸溴驺矧钺礤蝈篝泔溴啜溴驸蹰祠轭泔蝈钺礤楞镤濠换轴蜷徕戾ㄤ彐镳溴戾è簌簌礅镬钺礤铘骘蝽┅┅ㄥ趄徙ㄣ潋骘蝽鲠祯濠眭祠轲戾鲠祯瀛忾钿鲠痫螬祜镫躔簌泔溴ㄩㄥ耢痫戾铉翳篝徙泔溴┅蜥轶骘蝽⒂礅镬璃犰蝈徜溴骈铄轭翳痱弩孱筱镳瀹簌愆痱镧鲠簌鲠鲠祯瀛豉疱┅ㄡ痧孱洵孱趄泔溴ㄡ篌殓ㄥ黹立簌愆蝈泔溴鲠祯瀛豉疱┅┅┅┅ㄤ彐镳溴骁祜忉戾è簌簌礅镬钺礤铘骘蝽┅┅ㄥ趄徙ㄣ潋骘蝽鲠祯濠眭祠轲戾鲠祯瀛忾钿鲠痫螬祜镫躔簌泔溴ㄩㄥ耢痫癌蜥轶骘蝽⒂礅镬璃犰蝈徜溴骈铄轭翳珈镡犰筱镳瀹簌愆痱镧ㄡ痧孱洵孱趄ㄡ痧孱洵麸痨弼屐泔溴ㄥ黹⒗珈镡犰弪镩铋糸犰辁弪簌鲠祯瀛豉疱┅铋飑┅┅┅ㄤ彐镳箦戾è簌簌礅镬钺礤铘骘蝽┅┅ㄥ趄徙ㄣ潋骘蝽铄鳝鲠祯濠戾è鲠祜镫躔簌泔溴┅ㄩ鲠ㄡ痧孱洵孱趄泔溴篝矧铄鳝鲠祯瀛豉疱鲠铄鳝鲠祯濠蜥轶骘蝽⑽簌礅镬璃溴骈铄洚簌愆┅┅换旗秣蔑铘蝻ㄤ彐镳殒ㄥ趄徙骘蝽翦篝趄蹂怛犷汨驷祗瀛怛犷汨ㄩ铒ㄢ镲戾犷翦篝豉疱┅蜥轶骘蝽⒃桢豉疱镦翳翦篝屮痱弩箝镱麸ㄩ姗眭篝忮楸ㄢ镲戾犷┊ㄩ磲翥趄蹂怛犷汨豉疱驷祗瀛怛犷汨豉疱豁狒汨ㄡ痧孱洵孱趄泔溴ㄥ黹㈨蹊泔溴┅活磲翥蜥轶骘蝽⒃桢豉疱镦翳趄蹂犷驷祗怛犷汨弩眭篝磲翥琚┅┅ㄤ彐镳滹鏖翳铄鳝筱镳泔溴ㄥ趄徙舡扉篝骘蝽泔溴┅换歪翳屙狒殂ㄤ彐磲泸珏铄蜷悱赭镝蜱镳镳啜屮趄徙骘蝽ㄦ轵篝箦泔钿ㄩ磲翥骈蝮舡豉疱箦泔钿豉疱ㄡ痧孱洵孱趄泔溴ㄡ篌殓蝈泔溴骈蝮舡豉疱ㄥ黹连立镳骈蝮舡豉疱骈蝮箦泔钿豉疱箦泔钿┅ㄥ蝌矧⒃疱眭篝磲翥琚┅┅ㄤ彐镳徜ㄧ孱弪殂赭镝蜱镳⑨滗┅ㄤ彐镳驷滗ㄧ孱弪殂赭镝蜱镳㈡徜洧┅ㄤ彐镳篚ㄧ孱弪殂赭镝蜱镳Ⅲ踱┅ㄤ彐镳骟踱ㄧ孱弪殂赭镝蜱镳㈡篚猗┅ㄤ彐镳眭ㄧ孱弪殂赭镝蜱镳㈨蹯┅ㄤ彐镳骓蹯ㄧ孱弪殂赭镝蜱镳㈡眭膦┅ㄤ彐镳蹁轹ㄧ孱弪殂赭镝蜱镳Ⅴ溟觫┅ㄤ彐镳箐轹ㄧ孱弪殂赭镝蜱镳Ⅲ溟觫┅ㄤ彐镳驿轹ㄧ孱弪殂赭镝蜱镳㈡溟觫┅ㄤ彐镳躜屙ㄧ孱弪殂赭镝蜱镳Ⅴ蝈恝┅ㄤ彐镳篁屙ㄧ孱弪殂赭镝蜱镳Ⅲ蝈恝┅换麻赭轶橡弪狒轱铙ㄤ彐镳箬ㄧ孱弪殂赭镝蜱镳Ⅲ桁┅ㄤ彐镳祗栩ㄧ孱弪殂赭镝蜱镳㈧箬颌┅ㄤ彐镳狍栩ㄧ孱弪殂赭镝蜱镳⑨箬颌┅ㄤ彐镳忾舡犷ㄧ孱弪殂赭镝蜱镳⑨钿┅ㄤ彐镳忾舡矧ㄧ孱弪殂赭镝蜱镳矧┅ㄤ彐镳忾舡矧ㄧ孱弪殂赭镝蜱镳Ⅷ矧┅ㄤ彐镳怡翦篦狃ㄤ彐镳泔躅舡镱弩⒚秕铘翳铛礅弪镦箦忾趔轭犷轭翦珏虍ㄣ秕铘镱弩獗氨氨癌骄尝ㄥ趄徙骘蝽箫躜沐ㄡ痧孱洵麸痨弼屐ㄡ痧孱洵孱趄泔溴ㄡ篌殓蝈泔溴箫躜沐豉疱ㄢ轸镳泗痫稷箫躜沐豉疱箫躜沐┅ㄢ轸镳溴泗痫稷箫躜沐豉疱┅┅ㄤ彐镳泔躅舡戾徜轭绛镱弩ㄥ趄徙骘蝽箫躜沐ㄡ痧孱洵麸痨弼屐ㄡ痧孱洵孱趄泔溴ㄡ篌殓蝈泔溴箫躜沐豉疱ㄢ轸镳泗禚箫躜沐豉疱箫躜沐┅ㄢ轸镳溴泗禚箫躜沐豉疱舂┅ㄤ彐镳泔躅舡趄衢扉铉镱弩ㄥ趄徙骘蝽箫躜沐ㄡ痧孱洵麸痨弼屐ㄡ痧孱洵孱趄泔溴ㄡ篌殓蝈泔溴箫躜沐豉疱ㄢ轸镳泗酊箫躜沐豉疱箫躜沐┅ㄢ轸镳溴泗酊箫躜沐豉疱舂┅换蔑铞弪箝镱ㄤ彐磲泸珏铄蜷悱泔铞弪箝镱镳蝈篝鲠扉溽糸镱啜戾è麸疳蝮瀛豉疱铘骘蝽┅┅ㄥ趄徙骘蝽箫躜沐丽犰殇狒轱ㄡ痧孱洵孱趄泔溴ㄡ篌殓蝈泔溴麸ㄣ镱镳箫躜沐箫躜沐豉疱麸┅┅┅ㄤ彐镳趄躅汜翦⒃蝓钽狒犷轭翦珏虍趄躅汜翦卑楦骄卑ㄤ彐镳箦翦钿⑴翦钿犷轭翦珏痱弩弼轭翳箝珙ㄤ彐镳屮翦钿②弪锃屮翦钿犷轭翦珏虍ㄤ彐镳痿颦鹃铘ㄧ孱弪殂泔铞弪箝镱痿螋镩铘ㄣ镱è铒痫轭翦蚩箫躜沐豉疱┅ㄢ徜轭瘐舡豉疱骘蝽痿颦鹃铘痫轭翦颌箫躜沐豉疱┅è铒ㄩ铘彗弪麸┅ㄢ徜轭瘐舡豉疱骘蝽痿颦鹃铘㈤铘彗弪麸┅┅ㄤ彐镳轭舡攫趄ㄧ孱弪殂泔铞弪箝镱痿螋镩铘ㄣ镱è铒痫轭翦蚩箫躜沐豉疱┅ㄢ徜轭瘐舡豉疱骘蝽㈤铘攫趄㈤铘彗弪箫躜沐豉疱┅è铒ㄩ铘彗弪麸┅ㄢ徜轭瘐舡豉疱骘蝽㈤铘攫趄痫轭翦颌麸┅┅ㄤ彐镳忾翥狍⒚镱鲥螋犷镡赍泗麸犷轭翦珏镦羼踽箝瀹ㄤ彐镳泔弪沐⑻殡ㄢ轸汜篝怩轸滹瞌玳鲥骢汶徕秕箝瀹换麻翩殄熹箝ㄤ彐镳箝⒁弭躜翳箝镦犷镡赍泗轭怡翦螽箝卑骄换槎箝钞贝骄换滹踱戾箝ㄩ犯┅骄雹换尼翎篝蝓泗躜弩ㄤ彐镳豉疱ㄤ弩趄蹉趱蜷铉忾钿钺礤溴姗骘蝽ㄡ痧孱洵孱趄ㄤ彐轭瀛豉疱钺礤溴泔溴ㄡ篌殓瞽蝈ㄩ铘暴ㄣ镱篝犷ㄩ铘暴Ⅳ蝓澧┅┅ㄤ彐镳趱痨⒚蝈狒趱痨骝镯轸狎珲礤铘螽趱痨畅骄爆爆饼鏖翳豉疱槎船槎船槎待趱痨堍躞虔忾畀祗堍返旦骄堍躞虔忾畀祗堍返谍鏖翳豉疱楦槎待ㄥ趄徙舡扉篝骘蝽戾è趱瓠豉疱ㄡ珑蝈玑翦屮趄徙翦洵豉疱螬┅ㄡ痧孱洵孱趄泔溴祜镳骘骝镯麸ū戾铉翳屮趄徙翦洵豉疱螬泔祆邈糸铉戾è豉疱铘屮趄徙翦洵豉疱螬灬篝蝈蝈泔溴┅ㄡ篌殓蝈泔溴趱瓠豉疱ㄥ黹㈤铙弪赧犰蹂连连立趱瓠豉疱ㄩㄥ耢癌Ⅴ钿彐灬篝蝈绌豉疱铘屮趄徙翦洵蝈玳篝弪螬椹┅┅┅ㄤ彐泔蝈铘瑭ㄤ彐泔蝈徙沐篌换契钽糸镱溴骈铋糸镱犷汜祆轭ㄤ彐镳骢钽糸镱ㄤ彐轭瀛骢钽糸镱骘蝽泔溴┅ㄤ彐镳狃痨换皱泗矧｜ㄤ彐镳鲥泗矧⒚蝈狒鲥泗矧骝镯轸狎珲礤铘螽鲥泗矧暴骄急爆本鏖翳豉疱汲槎淳鲥泗矧钞贝骄弪蝻鲥泗矧鲥泗矧癌鲥泗矧癌鲥泗矧暴骄翳殇孱糸豉磲趄轼鏖翳豉疱脊槎淳ㄤ彐镳箬蹑骒濠换湾盹蝙｜ㄤ彐镳犰祜汜翦ㄤ彐镳篝矧濠ㄤ彐镳祜徜ㄤ彐镳泸遽翦ㄤ彐镳蝈犰祜汜翦ㄤ彐镳溴篝蝻ㄤ彐镳溴骓屙磲瞟ㄤ彐镳徜潋弩螬ㄤ彐镳骖换破ㄤ彐镳扉铍⑻轭麸骘蝈殓扉怛狎扉铍堍翘堍骄涕铍麸翳橡孱翘扉怛狎扉铍ㄣ狍矬瑚轭滹黧堍幽踢黹弪潇燔红轭貘堍扉庥奶唔轼弪箫堍┅骄涕铍麸翳幽烷弪扉怛狎轭痨狒骘蝽轭溴疱钿孱麽ㄥ趄徙骘蝽扉猢ㄡ痧孱洵孱趄ㄡ痧孱洵麸痨弼屐泔溴ㄥ黹溴沆狎楦漓轭毹楦┅ㄡ篌殓蝈泔溴ㄩ铘俯ㄣ犰㈧轭擘候弭ㄩ铘俯横蜱扉篝扉篝扉扉猸豉疱┅┅┅ㄤ彐镳骘蝈殓⒛彐轭骘蝈殓骢钽糸镱澡骈蝮狎珲礤铘轶麒弭桢轸骝镯矧毛扉怛狎澡轶轭骘蝽狒轱轶躞邃怡腮灬麸溴翦蝽轭麒弭桢麸磲铉戾翳钺礤镦翳骢钽糸镱犷栾麸滹箫换烫滞犷馏箦礅戾ㄤ彐镳狍愆ㄤ彐镳轭扉铄狍愆ㄤ彐镳烫滞⒘痧孱篝蜷铉镦烫滞梢麸翳珈镡犰筱镳瀹戾è狍铘骘蝽┅ㄡ痧孱洵麸痨弼屐泔溴狍愆┅ㄤ彐镳轭扉铄烫滞⒘痧孱篝蜷铉镦烫滞梢轭翳沲蝌孱泔铘屮舢戾è狍铘骘蝽┅ㄡ痧孱洵孱趄泔溴狍愆┅ㄤ彐疳蜥礤翦轭轸獒飙泔溴磲脲轭篝犷沐Ъ泔溴猴疱蜥麸蝮镳弪狒矧螵恒矧泔蝈┅换深趄矬疱泗轱ㄤ彐镳溴沆狎濠ㄤ彐镳蝈玳篝弪ㄤ彐镳祜汜飑ㄤ彐镳珈镡犰ㄤ彐镳觊舂